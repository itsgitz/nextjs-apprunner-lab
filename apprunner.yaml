version: 1.0
runtime: nodejs20
build:
    commands:
        pre-build:
            - npm install
        build:
            - npm run build
        post-build:
            # Copy public folder for static assets (images, fonts, etc.)
            - if [ -d "public" ]; then cp -r public .next/standalone/public; fi
            # Copy Next.js static build output (CSS, JS chunks)
            - mkdir -p .next/standalone/.next
            - cp -r .next/static .next/standalone/.next/static
    env:
        - name: NEXT_TELEMETRY_DISABLED
          value: "1"
run:
    command: node server.js
    work_dir: .next/standalone
    network:
        port: 8080
    env:
        - name: PORT
          value: "8080"
        - name: HOSTNAME
          value: "0.0.0.0"
        - name: NODE_ENV
          value: "production"
