version: 1.0
runtime: nodejs22
build:
    commands:
        pre-build:
            - npm ci --production=false
        build:
            - npm run build
        post-build:
            # Copy public folder to the project root level (parent of standalone)
            - cp -r public .next/standalone/../
            # Copy static folder to .next at project root level
            - cp -r .next/static .next/standalone/../.next/
run:
    command: node .next/standalone/server.js
    network:
        port: 3000
    env:
        - name: PORT
          value: "3000"
        - name: HOSTNAME
          value: "0.0.0.0"
        - name: NODE_ENV
          value: "production"
